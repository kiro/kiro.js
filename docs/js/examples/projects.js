// Generated by CoffeeScript 1.4.0
(function() {
  var bootstrap, docs, models, store;

  docs = window.BC.namespace("docs");

  docs.examples = window.BC.namespace("docs.examples");

  bootstrap = window.BC.namespace("bootstrap");

  models = window.BC.namespace("models");

  store = window.BC.namespace("store");

  $.extend(this, bootstrap, models, docs, store);

  docs.examples.projects = function() {
    return section(h1("Projects"), docs.code.projects(), example("Javascript projects", "Blatantly stolen from angularjs.", function() {
      var addProject, byId, content, projectForm, projectList, projects;
      byId = function(id) {
        return function(item) {
          return id && item._id.$oid === id.$oid;
        };
      };
      content = model("");
      projects = collection([]);
      mongoLab(projects, 'examples', 'projects');
      projectForm = function(project) {
        console.log(project);
        return form({
          Name: input.text({
            required: true
          }, bind(project.name)),
          Site: input.text({
            required: true,
            type: 'url'
          }, bind(project.site)),
          Description: textarea({
            required: true
          }, bind(project.description)),
          actions: [
            a({
              "class": 'btn btn-primary'
            }, "Save", function() {
              if (!projects.find(byId(project._id))) {
                projects.add(project);
              }
              return content(projectList());
            }), a({
              "class": 'btn'
            }, 'Cancel', function() {
              return content(projectList());
            }), a({
              "class": 'btn btn-danger'
            }, 'Delete', function() {
              projects.remove(byId(project._id));
              return content(projectList());
            })
          ]
        });
      };
      addProject = function() {
        return projectForm(object({
          name: "",
          site: "",
          description: ""
        }));
      };
      projectList = function() {
        var query;
        query = model("");
        return div(input.text({
          placeholder: "Search"
        }, query).on('keyup', function() {
          return projects.filter(function(item) {
            return JSON.stringify(item).toLowerCase().indexOf(query().toLowerCase()) !== -1;
          });
        }), table(thead(tr(th(td("Project"), td("Description"), td(a('+', function() {
          return content(addProject());
        })))))).foreach(projects, function(project) {
          return tr(td(a({
            href: project.site
          }, project.name)), td(project.description), td(a('Edit', function() {
            return content(projectForm(project));
          })));
        }));
      };
      content(projectList());
      return body(div(content));
    }));
  };

}).call(this);
