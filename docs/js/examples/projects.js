// Generated by CoffeeScript 1.4.0
(function() {
  var bootstrap, docs, models, store;

  docs = window.BC.namespace("docs");

  docs.examples = window.BC.namespace("docs.examples");

  bootstrap = window.BC.namespace("bootstrap");

  models = window.BC.namespace("models");

  store = window.BC.namespace("store");

  $.extend(this, bootstrap, models, docs, store);

  docs.examples.projects = function() {
    return section(h1("Projects"), docs.code.projects(), example("Javascript projects", "Blatantly stolen from angularjs.", function() {
      var addProject, app, byId, content, editProject, projectForm, projectList, projects;
      byId = function(id) {
        return function(item) {
          return item._id === id;
        };
      };
      content = model("");
      projects = collection([]);
      mongoLab(projects, 'examples', 'projects');
      projectForm = function(project) {
        return form({
          Name: input.text({
            required: true
          }, bind(project.name)),
          Site: input.text({
            required: true,
            type: 'url'
          }, bind(project.site)),
          Description: textarea({
            required: true
          }, bind(project.description)),
          "": [
            a({
              "class": 'btn',
              href: '#/examples/projects/list'
            }, "Save", function() {
              return projects.addOrUpdate(byId(project._id), project);
            }), a({
              "class": 'btn',
              href: '#/examples/projects/list'
            }, 'Cancel'), a({
              "class": 'btn btn-danger',
              href: '#/examples/projects/list'
            }, 'Delete', function() {
              return projects.remove(byId(project._id));
            }).bindVisible(bind(project._id))
          ]
        });
      };
      editProject = function(id) {
        return projectForm(projects.find(byId(id)).clone());
      };
      addProject = function() {
        return projectForm(object({
          name: "",
          site: "",
          description: ""
        }));
      };
      projectList = function() {
        var query;
        query = model("");
        div(input.text({
          placeholder: "Search"
        }, query).on('keyup', function() {
          return projects.filter(function(item) {
            return JSON.stringify(item).indexOf(query) !== -1;
          });
        }), table(thead(tr(th(td("Project"), td("Description"), td(a({
          href: '#/examples/projects/new'
        }, '+')))))).foreach(projects, function(project) {
          return tr(td(a({
            href: project.site
          }, project.name)), td(project.description), td(a({
            href: '#/examples/projects/edit/' + project.id
          }), "Edit"));
        }));
        return div(input.text({
          placeholder: 'Text'
        }));
      };
      app = Sammy('#projects', function() {
        this.get('#/examples/projects/', function() {
          return content(projectList());
        });
        this.get('#/examples/projects/edit/:id', function() {
          return content(editProject(this.params['id']));
        });
        return this.get('#/examples/projects/new', function() {
          return content(addProject());
        });
      });
      app.run("#/examples/projects/");
      return body(content);
    }, {
      id: 'projects'
    }));
  };

}).call(this);
